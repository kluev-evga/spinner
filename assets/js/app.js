!function(){"use strict";var e=class{constructor(e,t){this.links=[...e.children],this.options=this.calcOptions(t),this.spinnerContainer=this.createSpinnerContainer(e),this.spinnerBase=this.createSpinnerBase(),this.spinnerAxis=this.createSpinnerAxis(),this.createFacets(),this.addScroll(),this.angle=0,this.options.addScrollOnKeyboard&&this.addScrollOnKeyboard()}invert(e,t){return[e,t].reverse()}calcOptions(e){return e.height="number"==typeof e.height?e.height:100,e.linkWidth="number"==typeof e.linkWidth?e.linkWidth:20,e.spinnerLinkClass="string"==typeof e.spinnerLinkClass?e.spinnerLinkClass:"spinner__link",e.spinnerLinkClass=0===e.spinnerLinkClass.indexOf(".")?e.spinnerLinkClass.slice(1):e.spinnerLinkClass,e.linksCount=this.links.length>=3?this.links.length:3,e.step=360/e.linksCount,e.orientation="landscape"===e.orientation?"Y":"X",e.gap=e.gap>-1&&"number"==typeof e.gap?e.gap:-1,e.diameter=e.height*(.99-1/e.perspective**2*28e3-1/e.linksCount**2*3.6),e.linkHeight=Math.round(Math.tan(Math.PI/e.linksCount)*e.diameter)-e.gap,"Y"===e.orientation&&([e.linkHeight,e.linkWidth]=this.invert(e.linkHeight,e.linkWidth)),e.perspective="number"==typeof e.perspective?e.perspective:1500,e.counterStart="number"==typeof e.counterStart?e.counterStart:1,e}createSpinnerContainer(e){return e.style.cssText=`height: ${this.options.height}px;\n                                 width: 600px;\n                                 display: flex;\n                                 align-items: center;\n                                 justify-content: center;\n                                 cursor:grab;\n                                 overflow: hidden;\n                                 touch-action: none`,e}createSpinnerBase(){const e=document.createElement("div");return e.classList.add("spinner__base"),e.style.cssText=`width: ${this.options.linkWidth}px;\n                                     height: ${this.options.linkHeight}px;\n                                     transform-style: preserve-3d;\n                                     perspective: ${this.options.perspective}px;\n                                     transform: rotateY(${this.options.angle}deg)`,this.spinnerContainer.append(e),e}createSpinnerAxis(){const e=document.createElement("div");return e.classList.add("spinner__axis"),e.style.cssText="transform-style:preserve-3d;\n                                     width: 100%;\n                                     height: 100%;\n                                     transform: rotateX(0);\n                                     transition-duration: 0.1s;\n                                     transition-property: transform\n                                     transition-timing-function: ease-in-out",this.spinnerBase.append(e),e}createFacets(){const e=this,t=e.links,n=e.options.step,i=e.options.spinnerLinkClass,s=e.options.reverseContent,r=e.spinnerAxis,o=e.options.linksCount,a=e.options.diameter/2,p=e.options.orientation;let l=0;for(let e=0;e<o;e++){const o=document.createElement("div");o.classList.add(i),o.append(t[e]),o.style.cssText=`position: absolute;\n                                   width: 100%;\n                                   height: 100%;\n                                   transform: rotate${p}(${l}deg) translateZ(${a}px);\n                                   user-select:none;`,o.addEventListener("dragstart",(e=>{e.preventDefault()})),s?l+=n:l-=n,r.append(o)}}addScroll(){const e=this,t=e.options,n=e.spinnerContainer,i=e.spinnerAxis,s=(e.links,e.options.step),r=e.options.orientation,o=1/Math.cbrt(s)*.8;let a,p,l;const c=function(e){cancelAnimationFrame(this.animateId),n.style.cursor="grabbing",n.setPointerCapture(e.pointerId),n.addEventListener("pointermove",d,{capture:!0,passive:!0}),p=this.angle,l="Y"===r?e.clientX:e.clientY,a=Date.now()}.bind(this),d=function(e){let t="Y"===r?e.clientX-l:l-e.clientY;this.angle=p+t*o,i.style.transform=`rotate${r}(${this.angle}deg)`}.bind(this),h=function(e){this.spinnerContainer.style.cursor="grab",this.spinnerContainer.removeEventListener("pointermove",d,{capture:!0,passive:!0});const t=Date.now()-a,n=("Y"===r?e.clientX-l:l-e.clientY)/t;let i=400*Math.sqrt(Math.abs(n))+100;const o=30*n,p=this.angle;let c=0;Math.abs(o)<s/2?(c=-p%s,i*=1.6):c=o-(p+o)%s,this.animate.call(this,i,c,p)}.bind(this);n.addEventListener("pointerdown",c,{capture:!0,passive:!0}),n.addEventListener("pointerup",h,{capture:!0,passive:!0}),i.addEventListener("transitionend",(()=>{let e=parseFloat(i.style.transform.slice(8));if(Math.abs(e/360)>1){function t(){return e>0?e-=360:e+=360,Math.abs(e)>360&&t(),e}i.style.transitionDuration="",i.style.transform=`rotate${r}(${t()}deg)`,setTimeout((()=>{i.style.transitionDuration="0.1s"}))}}));let u=0;n.addEventListener("mousewheel",(e=>{e.preventDefault();let n=e.wheelDelta;if(Math.abs(n)<100&&(u+=n),u=n,Math.abs(u)<100)return;u=0,p=parseFloat(i.style.transform.slice(8));let r=n<0?p-s:p+s;i.style.transform=`rotate${t.orientation}(${r}deg)`}))}animate(e,t,n){const i=performance.now(),s=function(r){let o=(r-i)/e;o>1&&(o=1);let a=Math.sqrt(o);this.angle=n+a*t,this.spinnerAxis.style.transform=`rotate${this.options.orientation}(${this.angle}deg)`,o<1&&requestAnimationFrame(s)}.bind(this);this.animateId=requestAnimationFrame(s)}addScrollOnKeyboard(){const e=this,t=e.spinnerContainer,n=e.spinnerAxis,i=e.options.orientation,s=e.options.step;let r,o="Y"===e.options.orientation?"ArrowRight":"ArrowUp",a="Y"===e.options.orientation?"ArrowLeft":"ArrowDown";e.options.reverseControls&&({keyCodeForward:o,keyCodeBackward:a}={keyCodeForward:a,keyCodeBackward:o}),document.addEventListener("keydown",(e=>{r&&function(e){if(e.code===o){e.preventDefault();let t=parseFloat(n.style.transform.slice(8));n.style.transform=`rotate${i}(${t+s}deg)`}if(e.code===a){e.preventDefault();let t=parseFloat(n.style.transform.slice(8));n.style.transform=`rotate${i}(${t-s}deg)`}}(e)})),new IntersectionObserver(((e,t)=>{e[0].intersectionRatio>.9&&(r=!0),e[0].intersectionRatio<.9&&(r=!1)}),{threshold:[0,.95],margin:50}).observe(t)}};const t=new e(document.querySelector(".spinner"),{spinnerLinkClass:"spinner__link",height:700,linkWidth:250,gap:10,perspective:1500,angle:6,counterStart:1,addScrollOnKeyboard:!0});console.log(t);const n=document.querySelector(".spinner1");function i(e){let t=new DocumentFragment;for(let n=1;n<=e;n++){let e=document.createElement("div");e.innerText=n,t.append(e)}return t}n.append(i(30)),new e(n,{spinnerLinkClass:"spinner__link",height:300,linkWidth:80,gap:1,perspective:1500,angle:5,orientation:"landscape",reverseContent:!0});const s=document.querySelector(".spinner2");s.append(i(200)),s.append(i()),new e(s,{spinnerLinkClass:"spinner__link",height:700,linkWidth:30,gap:0,perspective:700,angle:0,counterStart:1})}();
//# sourceMappingURL=app.js.map